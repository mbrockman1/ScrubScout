{% extends 'core/base.html' %}
{% load static core_tags %}

{% block title %}{{ profile.display_name|default:profile.username }}'s Profile - ScrubScout{% endblock %}

{% block content %}
<div class="container mt-5">
    <div class="row">
        <div class="col-md-4">
            {% if profile.avatar %}
                <img src="{{ profile.avatar.url }}" alt="Avatar" class="img-fluid rounded-circle" style="width: 200px; height: 200px;">
            {% else %}
                <img src="{% static 'core/css/default-avatar.png' %}" alt="Default Avatar" class="img-fluid rounded-circle" style="width: 200px; height: 200px;">
            {% endif %}
            <h3>{{ profile.display_name|default:profile.username }}</h3>
            <p><strong>Location:</strong> {{ profile.location|default:"Not specified" }}</p>
            <p><strong>Joined:</strong> {{ profile.join_date|date:"F Y"|default:"Unknown" }}</p>
            <p><strong>Reviews:</strong> {{ profile.review_count|default:0 }}</p>
            <a href="{% url 'edit_profile' %}" class="btn btn-secondary">Edit Profile</a>
        </div>
        <div class="col-md-8">
            <h4>Bio</h4>
            <p>{{ profile.bio|default:"No bio yet." }}</p>
            <h4>Archived Reviews</h4>
            {% if user_reviews %}
                <ul class="list-group mb-3">
                    {% for review in user_reviews %}
                        <li class="list-group-item">
                            <a href="{% url 'review_detail' review_id=review.pk %}">{{ review.title }}</a> 
                            for {{ review.place.name }} ({{ review.created_at|date:"M d, Y" }})
                            <span class="badge bg-primary">{{ review.rating }} stars</span>
                        </li>
                    {% endfor %}
                </ul>
            {% else %}
                <p>No reviews yet.</p>
            {% endif %}
            {% if user == profile %}
                 <a href="{% url 'places:list' %}" class="btn btn-success">Write a Review</a>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}